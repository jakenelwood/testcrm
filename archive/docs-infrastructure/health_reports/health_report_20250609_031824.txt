[1mğŸ¥ Comprehensive Server Health Check[0m
==================================================
Timestamp: Mon Jun  9 03:18:24 AM UTC 2025
Primary Host: 5.78.103.224
Report File: /opt/crm/docs/reporting/health_reports/health_report_20250609_031824.txt

Running comprehensive health checks...


[1m[0;34mğŸŒ Host Connectivity Tests[0m
[0;34m==================================================[0m
[0;32mâœ… Primary host 5.78.103.224 is reachable[0m
[0;32mâœ… Backup host 5.161.110.205 is reachable[0m
[0;32mâœ… Backup host 178.156.186.10 is reachable[0m

[1m[0;34mğŸ”§ etcd Cluster Health[0m
[0;34m==================================================[0m
[0;32mâœ… etcd on 5.78.103.224 is healthy[0m
[0;32mâœ… etcd on 5.161.110.205 is healthy[0m
[0;32mâœ… etcd on 178.156.186.10 is healthy[0m
[0;32mâœ… etcd cluster is fully healthy (3/3 nodes)[0m

[1m[0;34mâ˜¸ï¸  K3s Cluster Health[0m
[0;34m==================================================[0m
[0;36mâ„¹ï¸  Checking K3s service status...[0m
[0;32mâœ… K3s service is running[0m
[0;32mâœ… All K3s nodes are Ready (3/3)[0m
[0;32mâœ… K3s core system pods are running (2/3)[0m

[1m[0;34mğŸ³ Docker Services Health[0m
[0;34m==================================================[0m
[0;36mâ„¹ï¸  Checking Docker service status...[0m
[0;32mâœ… Docker service is running[0m
[0;32mâœ… Docker containers are running (3/3)[0m
[0;32mâœ… PostgreSQL containers are running[0m

[1m[0;34mğŸ—„ï¸  Patroni PostgreSQL Cluster (Docker Compose)[0m
[0;34m==================================================[0m
[0;32mâœ… Patroni API on port 8008 is responding[0m
[0;32mâœ… Patroni cluster is healthy (1 leader, 2 replicas, 3 total)[0m
[0;32mâœ… PostgreSQL is accepting connections on port 5435[0m
[0;32mâœ… PostgreSQL is accepting connections on port 5433[0m
[0;32mâœ… PostgreSQL is accepting connections on port 5434[0m

[1m[0;34mğŸ—„ï¸  K3s PostgreSQL Cluster (Production)[0m
[0;34m==================================================[0m
[0;32mâœ… K3s postgres-cluster namespace is healthy (4/4 pods running)[0m
[0;32mâœ… PostgreSQL database pods are healthy (3/3 running)[0m
[0;32mâœ… Backup System pod backup-exporter-748c498fb6-h8sb6 is healthy (1/1 ready)[0m
[0;32mâœ… PostgreSQL Database pod postgres-0 is healthy (2/2 ready)[0m
[0;32mâœ… PostgreSQL Database pod postgres-1 is healthy (2/2 ready)[0m
[0;32mâœ… PostgreSQL Database pod postgres-2 is healthy (2/2 ready)[0m
[0;36mâ„¹ï¸  Checking K3s Patroni cluster leadership...[0m
[0;32mâœ… K3s Patroni leader found: postgres-2[0m
[0;32mâœ… PostgreSQL Cluster Service is configured[0m
[0;32mâœ… PostgreSQL Primary Service is configured[0m
[0;32mâœ… PostgreSQL Replica Service is configured[0m
[0;36mâ„¹ï¸  Checking K3s PostgreSQL backup system...[0m
[0;32mâœ… PostgreSQL backup CronJob is configured[0m
[0;36mâ„¹ï¸  No backup jobs found (CronJob may not have run yet)[0m
[0;36mâ„¹ï¸  Checking K3s PostgreSQL persistent volumes...[0m
[0;32mâœ… All PostgreSQL persistent volumes are bound (3/3)[0m

[1m[0;34mğŸš€ Application Services[0m
[0;34m==================================================[0m
[0;32mâœ… HAProxy Web Frontend is listening on port 8080[0m
[0;32mâœ… HAProxy Stats is listening on port 8404[0m
[0;32mâœ… HAProxy PostgreSQL LB is listening on port 5432[0m
[0;32mâœ… HAProxy K3s API LB is listening on port 6443[0m
[0;36mâ„¹ï¸  Checking K3s-based Supabase services...[0m
[0;32mâœ… Supabase Auth is running in K3s (2 pods)[0m
[0;32mâœ… Supabase REST is running in K3s (2 pods)[0m
[0;32mâœ… Supabase Storage is running in K3s (1 pods)[0m

[1m[0;34mğŸ—„ï¸  MinIO Distributed Storage[0m
[0;34m==================================================[0m
[0;36mâ„¹ï¸  Checking MinIO cluster status...[0m
[0;32mâœ… MinIO cluster is healthy (4/4 pods running)[0m
[0;32mâœ… MinIO S3 API service is available[0m
[0;32mâœ… MinIO Console service is available[0m
[0;36mâ„¹ï¸  Testing MinIO API health...[0m
[0;32mâœ… MinIO API health endpoint is responding[0m
[0;36mâ„¹ï¸  Checking MinIO buckets...[0m
[0;32mâœ… MinIO buckets are configured (5 CRM buckets found)[0m
[0;36mâ„¹ï¸  Checking MinIO storage usage...[0m
[0;32mâœ… MinIO storage is accessible and healthy (6 storage indicators)[0m
[0;36mâ„¹ï¸  Checking MinIO ingress configuration...[0m
[0;32mâœ… MinIO ingress is configured (2 ingress rules)[0m

[1m[0;34mğŸ’¾ Backup System Status[0m
[0;34m==================================================[0m
[0;32mâœ… Backup reports directory exists[0m
[0;36mâ„¹ï¸  Analyzing 2 recent backup reports...[0m
[0;32mâœ… Backup success rate: 100% (2/2 successful)[0m
[0;32mâœ… Latest backup: 2025-06-09T01:58:45+00:00 (36K, 21s)[0m
[0;32mâœ… Found 2 recent backup summaries[0m

[1m[0;34mğŸ”’ Security Compliance[0m
[0;34m==================================================[0m
[0;36mâ„¹ï¸  Security validation script found but application source code not available (infrastructure server)[0m
[0;32mâœ… Security validation should be run locally before deployment[0m
[0;32mâœ… No local .env.local file (using server-centralized management)[0m

[1m[0;34mğŸ“Š Health Check Summary[0m
[0;34m==================================================[0m

Overall Health Score: 100%
âœ… Passed: 46
âš ï¸  Warnings: 0
âŒ Failed: 0
ğŸ“‹ Total Checks: 46

ğŸ‰ EXCELLENT HEALTH - Production Ready!
